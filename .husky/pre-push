#!/bin/bash

echo 'ğŸ”€ğŸ”€ğŸ”€ Verifying branch status for GitHub Flow... ğŸ”€ğŸ”€ğŸ”€'

BRANCH=$(git rev-parse --abbrev-ref HEAD) # it returns the current branch name
PROTECTED_BRANCHES="^(master|main)$"

if [[ "$BRANCH" =~ $PROTECTED_BRANCHES ]]; then
    echo -e "\nâŒ Unable to push to remote $BRANCH branch. Please push your dev branch and create a pull request/merge request."
    exit 1
fi


if [[ "$BRANCH" =~ ^(develop|release\/[a-z0-9._-]+)$ ]]; then
    echo 'âœ…âœ…âœ… All checks passed for '$BRANCH'. Ready to push! âœ…âœ…âœ…'
    exit 0
fi


# Modify this regex according to your naming convention
if ! [[ "$BRANCH" =~ ^(feature|bugfix|hotfix|release|chore|build|ci|docs|perf|refactor|style|test)\/[a-z0-9._-]+$ ]]; then
  echo "Error: Branch name '$BRANCH' does not follow the convention."
  exit 1
fi

echo 'âœ…âœ…âœ… All checks passed. Ready to push! âœ…âœ…âœ…'


#feature: new feature or enhancement
#bugfix: bug fix in the codebase
#hotfix: urgent fix, typically for production
#release: preparing and managing a new version of the app
#chore: routine tasks, like maintenance, that donâ€™t alter functionality
#build: changes related to build processes or tools
#docs: updating or adding documentation
#refactor: improving code structure or readability without changing behavior
#style: formatting changes that do not affect the code's logic
#test: adding or updating tests
#ci: changes to continuous integration configurations or scripts
#perf: performance improvements in the codebase
